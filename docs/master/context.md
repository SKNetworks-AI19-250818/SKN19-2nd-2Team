# 프로젝트 개요

- 주제: 지역사회건강조사 기반 금연 성공률 예측 및 대시보드 구축
- 목표(정확 서술): 내원한 개인의 현재 특성으로 "금연 성공 확률"을 예측하고, 상담자가 바로 활용할 수 있도록 세분화·우선순위·맞춤 개입 제안을 제공하는 대시보드를 운영한다.
  - 예측의 용도: (1) 상담 강도/전략 결정, (2) 고위험군 조기 식별, (3) 경과 모니터링과 개입 효과 점검

## 배경 및 기대효과
- 금연 성공 가능성이 높은/낮은 대상자 구분으로 맞춤형 상담 및 자원 배분 효율화
- 데이터 기반 정책/캠페인 설계 근거 제공

## 데이터 및 해석 프레임
- 데이터: 지역사회건강조사(Community Health Survey, CHS) 원시자료
  - 결측치: 공식 배포본에는 기술적 결측은 없으나, "모름/무응답/해당없음" 등 특수 코드 값은 분석 관점에서 결측으로 간주하여 별도 처리한다.
  - 이상치: 코드 범위를 벗어나는 값은 없도록 설계되어 있으나, 수치형 파생 변수에 대해서는 IQR/분위수 기반 점검을 수행한다.
- 컬럼별 EDA: 분포·상관·교호작용 검토, 가설 수립/검증, 파생 변수 설계 기준 명시
- 목표 변수: 금연 성공 여부 y∈{0,1} (1=금연 성공, 고객 이탈)로 정의하여 이진 분류로 접근

## 모델링 전략
- 검증: K-Fold/Stratified Split, 베이스라인 → 튜닝 → 앙상블 비교
- 지표: 정확도/정밀도/재현율/F1/AUC, 운영환경에서의 해석 가능성 반영
- 최종 모델: 성능과 해석가능성의 균형 기반 선정

## 산출물
- docs/img/eda: 컬럼별 시각화(폴더 규칙: docs/img/eda/{컬럼코드}/dist.png 등)
- docs/summary/eda/데이터전처리결과서.md: 컬럼별 해석/전처리/가설/파생 변수
- docs/img/model: 모델 성능 시각화(ROC, PR, 중요도 등)
- docs/summary/model/인공지능학습결과서.md: 모델 비교표, 최종선정 사유, 한계/개선
- 최종 README.md: context.md의 요약을 반영한 프로젝트 안내문
- 모델 아티팩트: 모델 .pkl (추론에 필요한 전처리 파이프라인 포함 권장)
- streamlit: 금연클리닉용 대시보드 앱

## 코드 관리 구조
- notebooks: 탐색 및 실험
- smoke_churn_model / streamlit: 학습/평가/앱 코드
- docs: 문서 아카이브

## 전처리 요약(preprocess.py)
- 타깃 생성(`make_target`): 현재 흡연 지표(`sma_03z2 ∈ {1,2}` 또는 `sma_12z2==1` 또는 `sma_37z1 ∈ {1,2}`)가 모두 False이고, 과거 흡연 지표(`sma_03z2==3` 또는 `sma_12z2==2` 또는 `sma_37z1==3`)가 True이면 `churn=1`, 그 외 `0`. 액상형 특이 케이스는 `Liquid_method2`로 보정.
- 'b' 문자 전처리: `exmprs_no`, `CTPRVN_CODE`, `SPOT_NO` 등 식별자에 포함된 `b'0001'` 형태를 `'` 기준으로 분리해 실제 값만 사용.
- 설문 특수코드(7/8/9 계열) → NaN: 7=응답거부, 8=비해당, 9=모름(확장: 77/777 등). 범주형 의미를 왜곡하지 않기 위해 평균/최빈값 대치 대신 NaN 유지 후 모델 단계 처리.
- 파트별 전처리 후 `exmprs_no`,`churn` 기준 외부조인으로 병합.

## 용어/라벨 일관성 원칙
- 변수명·축 라벨·범주값은 매핑 테이블(labels.json)을 통해 한글화/설명 추가
- 수치형 코드의 의미(예: 1=남자, 2=여자)는 문서와 코드 모두 동일 매핑 사용

## 운영 가이드(요약)
- 데이터 파이프라인: 전처리 → 특성 생성 → 학습/평가 → 배포 아티팩트 저장
- 모델 모니터링 지표: 입력 데이터 드리프트, 성능 저하 알림, 재학습 기준

## 진행 체크리스트
- [ ] 기존 시각화 파일 정리해 docs/img/eda, docs/img/model로 이동
- [ ] 데이터전처리결과서(컬럼별) 작성 시작
- [ ] 인공지능학습결과서(모델 비교/선정) 작성 시작
- [ ] README에 문서 네비게이션 추가

## 상관 분석 요약(01_data_overview.ipynb 발췌)
참고: 상관계수는 단변량 지표로, 예측 모델 최종 기여도와는 다를 수 있습니다.

### 양의 상관계수
| 순위 | 변수명   | 상관계수  | 변수 의미                         |
|---:|:--------|---------:|:----------------------------------|
| 1 | smd_02z3 | 0.963292 | 최근1년금연시도여부 |
| 2 | smd_01z3 | 0.940259 | 금연계획 |
| 3 | smb_01z1 | 0.855602 | 매일흡연자하루흡연량 |
| 4 | sma_03z2 | 0.841061 | 일반담배현재흡연상태 |
| 5 | sma_37z1 | 0.343737 | 궐련형전자담배현재사용 |
| 6 | sma_36z1 | 0.316096 | 궐련형전자담배평생사용 |
| 7 | smb_11z1 | 0.292605 | 궐련형매일사용자하루사용량 |
| 8 | age      | 0.292371 | 만나이 |
| 9 | smb_03z1 | 0.224873 | 가끔흡연자일평균흡연량 |
| 10 | smb_02z1 | 0.223314 | 가끔흡연자월간흡연일수 |
| 11 | sma_11z2 | 0.180677 | 액상형전자담배현재사용 |
| 12 | sma_08z1 | 0.177574 | 액상형전자담배평생사용 |
| 13 | mtc_12c1 | 0.171099 | 잠자는데 발생한 문제_화장실 가려고 일어남 |
| 14 | smb_13z1 | 0.167065 | 궐련형가끔사용자일평균량 |
| 15 | smb_12z1 | 0.166137 | 궐련형가끔사용자월간일수 |

### 음의 상관계수
| 순위 | 변수명   | 상관계수   | 변수 의미                 |
|---:|:--------|----------:|:--------------------------|
| 1 | smb_06z1 | -0.931736 | 과거흡연자하루평균흡연량 |
| 2 | smb_04z1 | -0.931152 | 과거흡연자흡연기간_년 |
| 3 | smb_05z1 | -0.930900 | 과거흡연자흡연기간_월 |
| 4 | smb_09z1 | -0.694634 | 금연유지기간 |
| 5 | nua_01z2 | -0.236455 | 아침식사빈도 |
| 6 | mtj_11z1 | -0.222855 | 연간 치매선별검사 수진 여부 |
| 7 | sod_02z3 | -0.220719 | sod_02z3 |
| 8 | sca_01z1 | -0.197668 | sca_01z1 |
| 9 | mtj_05z2 | -0.155501 | 인지장애 경험 여부 |
| 10 | drb_01z3 | -0.151565 | 연간음주빈도 |
| 11 | hya_30z1 | -0.149768 | hya_30z1 |
| 12 | hya_14b2 | -0.148698 | hya_14b2 |
| 13 | hya_14a2 | -0.145243 | hya_14a2 |
| 14 | hya_14c2 | -0.145211 | hya_14c2 |
| 15 | hya_15z1 | -0.144361 | hya_15z1 |

## 가설 정리
아래 표는 본 프로젝트에서 세운 주요 가설과 대응 변수 예시입니다. 이후 EDA/모델링 단계에서 검증·보완합니다.

| 구분 | 주요 변수 예시 | 가설 (Hypothesis) |
| --- | --- | --- |
| 가구환경 | fma_14z1(월평균소득), nue_01z1(식품안정성) | H1 : 가구소득이 높고 식품안정성이 높은 가구일수록 금연성공률이 높을 것이다. |
| 음주행태 | drb_01z3(음주빈도), drb_03z1(1회 음주량), drb_04z1/05z1(폭음빈도), drg_01z3(금주계획) | H2 : 음주빈도가 높거나 폭음 빈도가 높은 사람은 금연성공률이 낮을 것이다.  \\ H3 : 절주·금주 계획이 있는 사람은 금연성공률이 높을 것이다. |
| 신체활동 | pha_04z1(고강도활동일수), pha_07z1(중강도활동일수), phb_01z1(걷기일수) | H4 : 신체활동 빈도가 높을수록 자기조절능력이 높아 금연성공률이 높을 것이다. |
| 식생활 | nua_01z2(아침식사빈도), nuc_02z1(영양표시 인지), nuc_03z1(영양표시 활용) | H5 : 아침식사 빈도가 적을수록 생활습관이 불규칙해 금연성공률이 낮을 것이다.  \\ H6 : 영양표시에 관심이 높은 사람은 건강의식이 높아 금연성공률이 높을 것이다. |
| 비만 및 체중조절 | oba_03z1(체중), obb_01z1(체중조절경험), obb_02c1(식사량조절) | H7 : 체중조절을 시도한 사람은 자기통제력이 높아 금연성공률이 높을 것이다. |
| 구강건강 | ora_01z1(주관적 구강건강), ord_01d2(점심 칫솔질 여부), ore_07z1(스케일링경험) | H8 : 구강건강이 좋거나 관리습관이 있는 사람일수록 금연성공률이 높을 것이다. |
| 정신건강 | mta_01z1(스트레스인지), mtb_01z1(우울감경험), mtc_17z1(수면시간) | H9 : 스트레스와 우울감이 높을수록 금연성공률이 낮을 것이다.  \\ H10 : 충분한 수면시간을 확보한 사람은 금연성공률이 높을 것이다. |
| 주관적건강/삶의질 | qoa_01z1(주관적건강), ql_c1200(EQ-5D지수) | H11 : 자신의 건강상태를 긍정적으로 인식할수록 금연성공률이 높을 것이다. |
| 보건기관 이용 | hma_01z3(보건기관 이용), sra_01z3(미충족의료) | H12 : 보건기관 이용률이 높을수록 금연캠페인 및 상담 노출 가능성이 커 금연성공률이 높을 것이다. |
| 교육 및 경제활동 | sob_01z1(학력), soa_06z2(직업), dr_a0400(음주지표와의 교차) | H13 : 교육수준과 직업 안정성이 높을수록 금연성공률이 높을 것이다. |
