# 프로젝트 마스터 문서 (Context)

본 문서는 "지역사회건강조사 기반 금연 성공률 예측 및 대시보드 구축" 프로젝트의 전체 내용을 담고 있습니다.

---

## 1. 프로젝트 개요

### 1-1. 프로젝트 정보
- **프로젝트명**: 지역사회건강조사 기반 금연 성공률 예측 및 대시보드 구축
- **기간**: 2025.09.30 ~ 2025.10.15
- **팀명**: 이조는 차분하조
- **팀원**: 5인 (김소희, 마한성, 박도연, 오흥재, 임상민)

### 1-2. 프로젝트 목표
**정확한 목표 서술:**
내원한 개인의 현재 특성으로 "금연 성공 확률"을 예측하고, 상담자가 바로 활용할 수 있도록 세분화·우선순위·맞춤 개입 제안을 제공하는 대시보드를 운영한다.

**예측의 용도:**
1. 상담 강도/전략 결정
2. 고위험군 조기 식별
3. 경과 모니터링과 개입 효과 점검

### 1-3. 프로젝트 배경 및 필요성
- 금연 성공 가능성이 높은/낮은 대상자 구분으로 맞춤형 상담 및 자원 배분 효율화
- 데이터 기반 정책/캠페인 설계 근거 제공
- 금연을 하고자 하는 사람들에게 구체적인 행동 교정을 통해 목표 달성을 보다 수월하게 지원

### 1-4. 기대 효과
- 공공보건정책에서 금연 성공 가능성이 낮은 집단을 사전에 파악 가능
- 지역별·계층별 금연지원 프로그램 설계의 근거 데이터 제공
- 향후 "맞춤형 금연 지원 서비스" 개발로 확장 가능
- 금연 클리닉에서 개인별 특성 입력 시 즉각적인 금연 성공 확률 및 개선 방향 제시

---

## 2. 데이터 이해

### 2-1. 데이터 출처
- **출처**: 2024년 지역사회건강조사 (Community Health Survey, CHS) 원시자료
- **조사 기관**: 질병관리청 및 지역 보건소
- **조사 대상**: 조사시점에 표본가구에 거주하는 만 19세 이상 성인
- **조사 기간**: 2024년 5월 16일 ~ 7월 31일
- **조사 형태**: 단면조사 (Cross-sectional) - 특정 시점의 스냅샷
- **조사 방법**: 가구 방문 면접 조사

### 2-2. 데이터 규모 및 특성
**원시 데이터:**
- **규모**: 231,728명 (rows) × 209개 변수 (columns)
- **주요 조사 영역**: 가구조사, 건강행태, 음주, 흡연, 신체활동, 식생활, 비만 및 체중조절, 구강건강, 정신건강, 보건기관 이용, 교육 및 경제활동 등

**분석 대상 데이터:**
- **필터링 기준**: 과거 또는 현재 흡연 경험이 있는 응답자
- **최종 분석 대상**: 89,822명 (전체의 약 38.8%)
- **전처리 후 규모**: 89,822 rows × 83 columns (최종 학습 데이터)

**데이터 특성:**
- **결측치**: 공식 배포본에는 기술적 결측은 없으나, "모름/무응답/해당없음" 등 특수 코드 값(7, 8, 9, 77, 777 등)은 분석 관점에서 결측으로 간주하여 NaN 처리
- **이상치**: 코드 범위를 벗어나는 값은 없도록 설계되어 있으나, 수치형 파생 변수에 대해서는 IQR/분위수 기반 점검 수행
- **클래스 분포**: 금연 성공 54.8% vs 금연 실패 45.2% (비교적 균형적)

### 2-3. 타겟 변수 정의
**목표 변수:** 금연 성공 여부 `churn` ∈ {0, 1}
- **churn = 1** (금연 성공, 고객 이탈): 현재 비흡연 + 과거 흡연 경험 → 49,251명 (54.8%)
- **churn = 0** (금연 실패, 고객 유지): 현재 흡연 중 → 40,571명 (45.2%)

**정의 로직:**
- 현재 흡연: `sma_03z2 ∈ {1,2}` 또는 `sma_12z2 == 1` 또는 `sma_37z1 ∈ {1,2}`
- 과거 흡연: `sma_03z2 == 3` 또는 `sma_12z2 == 2` 또는 `sma_37z1 == 3`
- 금연 성공: 현재 흡연이 모두 False이고, 과거 흡연이 True인 경우
- 특수 처리: 액상형 전자담배 최근 1달 사용일수>0인데 churn=1인 모순은 `Liquid_method2`로 보정

---

## 3. 데이터 전처리

### 3-1. 데이터 정제 프로세스 (5단계)

```
 1. raw_data.csv (231,728 rows × 209 columns)
   ↓ 타겟 변수 생성 (churn)
 
 2. analy_data_v2.csv (89,822 rows × 210 columns)
   ↓ 공통 전처리 ('b'문자 삭제, NaN 변환)
 
 3. 전처리 완료 (89,822 rows × 75 columns)
   ↓ 파생변수 생성 (30개 추가)
 
 4. 파생변수 생성 완료 (89,822 rows × 105 columns)
   ↓ 원본 변수 제거 (22개)
 
 5. prep_data_v2.csv (89,822 rows × 83 columns) → 모델 학습 준비 완료
```

### 3-2. 주요 전처리 작업

#### 타깃 생성 (make_target)
```python
# 현재 흡연 여부 (하나라도 현재 피우고 있으면 흡연 중)
currently_smoking = (
    anal_data['sma_03z2'].isin([1, 2]) |
    (anal_data['sma_12z2'] == 1) |
    anal_data['sma_37z1'].isin([1, 2])
)

# 과거에 피웠으나 현재 피우지 않음
stop_smoked = (
    (anal_data['sma_03z2'] == 3) |
    (anal_data['sma_12z2'] == 2) |
    (anal_data['sma_37z1'] == 3)
)

# 금연 성공자: 현재는 흡연 안 하고, 과거엔 피운 적 있음
anal_data['churn'] = np.where(
    (~currently_smoking) & stop_smoked,
    1,  # 금연 성공
    0   # 금연 실패
)

# 액상형 특이 케이스 보정
anal_data = Liquid_method2(anal_data)
```

#### 'b' 문자 전처리
```python
# 식별자 코드에 포함된 b'0001' 형태를 ' 기준으로 분리해 실제 값만 사용
for c in ['exmprs_no', 'CTPRVN_CODE', 'SPOT_NO']:
    if c in df.columns:
        df[c] = df[c].apply(lambda x: str(x).split("'")[1] if "'" in str(x) else x)
```

#### 설문 특수코드 → NaN 처리
```python
# 7=응답거부, 8=비해당, 9=모름 (77, 777 등 확장 코드 포함)
# 범주형 의미를 왜곡하지 않기 위해 평균/최빈값 대치 대신 NaN 유지
for c in ['nua_01z2','nuc_02z1','drb_01z3','drb_03z1']:
    if c in df.columns:
        df.loc[df[c] >= 7, c] = np.nan
```

**처리 이유:**
- 대부분의 설문 항목은 범주형 (예: 교육수준 1=무학, 2=서당, ..., 10=대학원)
- 7/8/9는 유효한 범주가 아닌 비응답/비해당 상태
- 평균/최빈값 대치 시 응답 의미 왜곡 발생
- NaN 유지 후 모델 단계에서 적절한 인코딩/결측 처리 수행

### 3-3. 주요 파생변수 및 선정 근거

| 구분 | 대표 변수(예시) | 선정 근거(핵심) | 금연성과 기대 방향 |
| --- | --- | --- | --- |
| **경제활동/직업** | `education_group`, `occupation_type`, `is_economically_active`, `is_employee`, `marital_stability` | 경제활동 지위·고용 안정성은 건강행태·의지와 연동. 비경제활동 별도 표기가 설명력 향상 | 양(+), 집단 구분 효과 큼 |
| **가구/소득** | `age_group`, `is_single`, `house_income`, `house_income_log`, `house_income_grp`, `fma_dementia_case` | 건강 문해력·자원 접근성 차이를 반영 | 양(+) |
| **혼인/사회적 지지** | `marital_stability` | 사회적 지지/환경 요인 반영 | 양(+) |
| **식생활** | `nua_01z2`, `nuc_02z1` | 규칙적 식생활·건강의식 지표 | 양(+) |
| **음주** | `drb_01z3`, `drb_04z1`, `drb_05z1`, `drg_01z3` | 음주/폭음은 부정적, 금주 계획은 긍정적 | 음(-)·양(+) 공존 |
| **신체활동** | `weight_control_method`, `activity_score` | 자기조절·건강행태 지표 | 양(+) |
| **시간변환** | `edit_mtc_03z1` 등 | 시간-분 통합으로 수면시간 정확도 향상 | 양(+) |

**파생변수 생성 예시 (경제활동 상태):**
```python
def add_economic_status_features(df):
    df = df.copy()
    df['is_economically_inactive'] = (df['soa_06z2'] == 88).astype(int)
    df['is_economically_active']   = (df['soa_06z2'] != 88).astype(int)
    df['economic_status'] = np.where(df['is_economically_inactive']==1,
                                     '비경제활동인구','경제활동인구')
    return df
```

### 3-4. 원본 데이터의 주요 문제점 및 해결

**문제 1: 복잡한 카테고리 (교육수준)**
- 원본: sob_01z1 - 10개 카테고리 (무학/서당/초졸/중졸/고졸/전문대/대졸/대학원 등)
- 문제: 세분화 과다로 패턴 파악 어려움
- 해결: education_group 3그룹 (저/중/고) 단순화 → **70% 감소**

**문제 2: 극소수 카테고리 (직업)**
- 원본: soa_06z2 - 13개 카테고리
- 문제: 군인 404명 (0.46%), 불균형 심각
- 해결: occupation_type 3그룹 (화이트/블루/비활동) → **77% 감소**

**문제 3: 극단적 불균형 (혼인상태)**
- 원본: sod_02z3 - 7개 카테고리, 무응답 17명
- 문제: 최대 3506:1 불균형 비율
- 해결: marital_stability 3그룹 (안정/미혼/불안정) → **57% 감소**

**평균 단순화율: 64.1%** → 모델 효율성 및 학습 안정성 향상

---

## 4. 탐색적 데이터 분석 (EDA)

### 4-1. 상관 분석 요약
참고: 상관계수는 단변량 지표로, 예측 모델 최종 기여도와는 다를 수 있습니다.

#### 양의 상관계수 (Top 15)
| 순위 | 변수명   | 상관계수  | 변수 의미                         |
|---:|:--------|---------:|:----------------------------------|
| 1 | smd_02z3 | 0.963292 | 최근1년금연시도여부 |
| 2 | smd_01z3 | 0.940259 | 금연계획 |
| 3 | smb_01z1 | 0.855602 | 매일흡연자하루흡연량 |
| 4 | sma_03z2 | 0.841061 | 일반담배현재흡연상태 |
| 5 | sma_37z1 | 0.343737 | 궐련형전자담배현재사용 |
| 6 | sma_36z1 | 0.316096 | 궐련형전자담배평생사용 |
| 7 | smb_11z1 | 0.292605 | 궐련형매일사용자하루사용량 |
| 8 | age      | 0.292371 | 만나이 |

#### 음의 상관계수 (Top 10)
| 순위 | 변수명   | 상관계수   | 변수 의미                 |
|---:|:--------|----------:|:--------------------------|
| 1 | smb_06z1 | -0.931736 | 과거흡연자하루평균흡연량 |
| 2 | smb_04z1 | -0.931152 | 과거흡연자흡연기간_년 |
| 3 | smb_05z1 | -0.930900 | 과거흡연자흡연기간_월 |
| 4 | smb_09z1 | -0.694634 | 금연유지기간 |
| 5 | nua_01z2 | -0.236455 | 아침식사빈도 |

### 4-2. 가설 정리
아래 표는 본 프로젝트에서 세운 주요 가설과 대응 변수 예시입니다. EDA/모델링 단계에서 검증·보완했습니다.

| 구분 | 주요 변수 예시 | 가설 조건 | 예상 결과 |
| --- | --- | --- | --- |
| **가구환경** | fma_14z1(월평균소득), nue_01z1(식품안정성) | H1: 가구소득이 높고 식품안정성이 높은 가구일수록 | 금연성공률이 높을 것이다. |
| **음주행태** | drb_01z3(음주빈도), drb_03z1(1회 음주량), drb_04z1/05z1(폭음빈도), drg_01z3(금주계획) | H2: 음주빈도가 높거나 폭음 빈도가 높은 사람은<br>H3: 절주·금주 계획이 있는 사람은 | 금연성공률이 낮을 것이다.<br>금연성공률이 높을 것이다. |
| **신체활동** | pha_04z1(고강도활동일수), pha_07z1(중강도활동일수), phb_01z1(걷기일수) | H4: 신체활동 빈도가 높을수록 자기조절능력이 높아 | 금연성공률이 높을 것이다. |
| **식생활** | nua_01z2(아침식사빈도), nuc_02z1(영양표시 인지), nuc_03z1(영양표시 활용) | H5: 아침식사 빈도가 높을수록 생활습관이 규칙적이고<br>H6: 영양표시에 관심이 높은 사람은 건강의식이 높아 | 금연성공률이 높을 것이다.<br>금연성공률이 높을 것이다. |
| **비만/체중조절** | oba_03z1(체중), obb_01z1(체중조절경험), obb_02c1(식사량조절) | H7: 체중조절을 시도한 사람은 자기통제력이 높아 | 금연성공률이 높을 것이다. |
| **구강건강** | ora_01z1(주관적 구강건강), ord_01d2(점심 칫솔질 여부), ore_07z1(스케일링경험) | H8: 구강건강이 좋거나 관리습관이 있는 사람일수록 | 금연성공률이 높을 것이다. |
| **정신건강** | mta_01z1(스트레스인지), mtb_01z1(우울감경험), mtc_17z1(수면시간) | H9: 스트레스와 우울감이 낮을수록<br>H10: 충분한 수면시간을 확보한 사람은 | 금연성공률이 높을 것이다.<br>금연성공률이 높을 것이다. |
| **주관적건강/삶의질** | qoa_01z1(주관적건강), ql_c1200(EQ-5D지수) | H11: 자신의 건강상태를 긍정적으로 인식할수록 | 금연성공률이 높을 것이다. |
| **보건기관 이용** | hma_01z3(보건기관 이용), sra_01z3(미충족의료) | H12: 보건기관 이용률이 높을수록 금연캠페인 및 상담 노출 가능성이 커 | 금연성공률이 높을 것이다. |
| **교육/경제활동** | sob_01z1(학력), soa_06z2(직업), dr_a0400(음주지표 교차) | H13: 교육수준과 직업 안정성이 높을수록 | 금연성공률이 높을 것이다. |

### 4-3. 주요 검증 결과 (대표 사례)

**가구 환경:**
- 고연령층일수록 금연 이탈 가능성이 높음
- 여성은 남성보다 이른 연령대에서 금연 시작
- 1인 가구의 이탈률이 낮음 (사회적 지지 부족 가능성)
- 비수급자의 이탈률이 높음

**음주 행태:**
- 폭음 빈도가 높을수록 금연 실패 비율 증가 (자기조절 능력과 연관)
- 금주 계획이 있는 집단의 이탈률이 높음 (건강 의지 반영)

**Feature Engineering 효과:**
1. 혼인상태 (marital_stability): 21.9%p 차이
2. 교육수준 (education_group): 17.4%p 차이
3. 직업 (occupation_type): 14.6%p 차이
4. 경제활동 (is_economically_active): 13.7%p 차이

---

## 5. 모델링

### 5-1. 모델링 전략
- **문제 정의**: 이진 분류 (Binary Classification) - 금연 성공(1) vs 실패(0)
- **데이터 분할**: Stratified 기반 학습/검증/테스트 분리 (8:2), 클래스 비율 유지
- **검증 방법**: Stratified K-Fold(K=5) 교차검증으로 성능 안정성 확인
- **평가지표**: ROC-AUC(주지표), Accuracy, PR-AUC(불균형 보정)
- **모델 후보**: CatBoost, XGBoost, LightGBM, HistGradientBoosting
- **최종 선택**: 하이퍼파라미터 그리드탐색 후 AUC 기준 최고 성능 모델 선정

**AUC를 주평가지표로 선택한 이유:**
1. 분류 임계값에 덜 민감하여 전체 구간 성능을 평가
2. 클래스 불균형 상황에서도 강건
3. 운영 단계에서 임계값 조정 시에도 모델 간 우열 비교 가능

### 5-2. 데이터 분할 및 전처리
```python
# notebooks/team/05_ML모델비교.ipynb 발췌
from sklearn.model_selection import train_test_split

# 데이터 분리
X = df_test.drop(TARGET_NM, axis=1)
y = df_test[TARGET_NM]

# 학습/테스트 (8:2)
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, stratify=y, random_state=2
)
# 결과: (71857, 41) (71857,) (17965, 41) (17965,)
```

**범주형 변수 처리:**
- **CatBoost**: 내장 `cat_features` 지정, 자동 인코딩
- **XGBoost/LightGBM**: `astype('category')` 변환 후 `enable_categorical=True`
- **HistGradientBoosting**: sklearn 1.2+ 범주형 지원

### 5-3. 모델 학습 및 성능 비교

**초기 하이퍼파라미터 (각 팀원 실험 결과 종합):**
```python
catb_params = {
    'iterations': 500, 'learning_rate': 0.05, 'depth': 6,
    'eval_metric': 'Accuracy', 'verbose': 100
}
xgb_params = {
    'n_estimators': 300, 'max_depth': 6, 'learning_rate': 0.07,
    'subsample': 0.9, 'colsample_bytree': 0.9,
    'tree_method': "hist", 'eval_metric': "aucpr"
}
lgb_params = {
    'objective': 'binary', 'boosting_type': 'gbdt',
    'learning_rate': 0.05, 'num_leaves': 31, 'class_weight': 'balanced'
}
hgb_params = {
    'learning_rate': 0.01, 'max_depth': 5, 'max_iter': 300
}
```

**학습 결과:**
| 모델 | Accuracy | ROC_AUC | PR_AUC | 학습시간(초) |
| :--- | ---:| ---:| ---:| ---:|
| **CatBoost** | **0.707041** | **0.778440** | **0.792318** | 100.078 |
| LightGBM | 0.706151 | 0.776717 | 0.791158 | 0.531 |
| HistGradientBoosting | 0.697356 | 0.769087 | 0.782641 | 3.458 |
| XGBoost | 0.692124 | 0.761414 | 0.778780 | 2.301 |

> CatBoost가 ROC-AUC, PR-AUC 모두 최고 성능

### 5-4. 최종 모델 성능 (CatBoost, test set)
- **Accuracy**: 0.7067
- **ROC-AUC**: 0.7784
- **PR-AUC**: 0.7923

### 5-5. 최종 모델 선정 사유
**CatBoost 선택 이유:**
1. **범주형 처리 우수**: 원-핫 인코딩 없이 자동 처리, 정보 손실 최소화
2. **성능 우위**: ROC-AUC 0.7784, PR-AUC 0.7923으로 비교 모델 대비 최고
3. **해석성**: 내장 특성 중요도 및 Pool 기반 리포트 제공
4. **안정성**: 교차검증에서 일관된 성능 유지

### 5-6. 실험 요약 (특성 중요도 관찰)
- 두 모델(결정트리, 히스토그램 그라디언트 부스팅) 모두에서 반복적으로 상위에 등장한 변수:
  - 궐련형전자담배 사용
  - 연령 (age, age_group)
  - 혼인상태 (marital_stability)
  - 체중조절 관련 변수
  - 음주지표 (drb_01z3, drg_01z3)
  - 구강건강평가 (ora_01z1)
  
- **해석 주의**: 특성 중요도는 "관련성" 신호일 뿐, 인과관계가 아님
- **피처 축소 영향**: 58→42개로 축소 후 단일 변수(age_group) 의존도가 증가하며 일반화 성능 하락 가능성 관찰
- **모델 비교**: 동일 피처셋(42)에서 트리 단일모델(DT) 대비 HGB가 더 견고하고 성능 우위

**실험 레퍼런스 (Notion):**
| 실험 | 설명 | 링크 |
| --- | --- | --- |
| [1] Decision Tree (58변수) | analy_data + 개인컬럼식별 | [바로가기](https://www.notion.so/1-DECISION-TREE-analy_data-58-28c649136c118017b8c4f683ec757378?pvs=21) |
| [2] 트리모델 비교 (58변수) | DecisionTree vs HGB 등 비교 | [바로가기](https://www.notion.so/2-analy_data-58-28c649136c118049b1e0c3363e5b41d4?pvs=21) |
| [3] Decision Tree (42변수) | analy_data_v2 축소 피처 | [바로가기](https://www.notion.so/3-DECISION-TREE-analy_data_v2-42-28c649136c118017b8c4f683ec757378?pvs=21) |
| [4] 트리모델 비교 (42변수) | 축소 피처셋 비교 | [바로가기](https://www.notion.so/4-analy_data_v2-42-28c649136c11807ba527e278a691eff9?pvs=21) |

---

## 6. 산출물

### 6-1. 문서 산출물
| 구분 | 파일명 | 설명 | 경로 |
| --- | --- | --- | --- |
| 데이터 분석 | 데이터전처리결과서.md | 컬럼별 EDA, 전처리, 가설, 파생변수 | `docs/summary/eda/` |
| 모델 분석 | 인공지능학습결과서.md | 모델 비교표, 최종 선정 사유, 한계/개선 | `docs/summary/model/` |
| 프로젝트 마스터 | context.md | 전체 프로젝트 내용 통합 문서 | `docs/master/` |
| 최종 안내문 | README.md | 프로젝트 소개 및 주요 내용 요약 | 루트 |

### 6-2. 시각화 산출물
| 구분 | 설명 | 경로 |
| --- | --- | --- |
| EDA 시각화 | 컬럼별 분포, 상관관계, 가설 검증 시각화 | `docs/img/eda/` |
| 모델 시각화 | 혼동행렬, ROC/PR Curve, 특성 중요도 | `docs/img/model/` |

### 6-3. 모델 아티팩트
- **모델 파일**: CatBoost 학습 모델 (.pkl 형태 권장)
- **전처리 파이프라인**: 추론에 필요한 전처리 포함
- **저장 위치**: `smoke_churn_model/` 또는 `notebooks/team/results/`

### 6-4. 대시보드 (Streamlit)
- **앱 위치**: `streamlit/app.py`
- **주요 기능**:
  1. 환자 정보 입력 페이지
  2. 금연 성공 확률 예측
  3. 상담자 전용 페이지 (PDF 리포트 생성)
  4. 개인별 맞춤 개입 제안

---

## 7. 프로젝트 관리

### 7-1. 코드 관리 구조

```text
# 데이터 저장소
data/
  ├─ raw_data.csv           # 원본 데이터
  ├─ analy_data_v2.csv      # 1차 전처리 데이터 (churn 추가)
  └─ prep_data_v2.csv       # 2차 전처리 데이터 (최종)

# EDA · ML 실험 공간
notebooks/
 ├─ 김소희/ (sosodoit)
 ├─ 마한성/ (gitsgetit)
 ├─ 박도연/ (doyeon)
 ├─ 오흥재/ (vfxpedia)
 ├─ 임상민/ (sangmin)
 └─ team/                    # 팀 리뷰 및 최종 통합
    ├─ 01_데이터정제.ipynb     # 데이터 전처리 코드 통합 
    ├─ 02_ML학습준비.ipynb    # 모델 테스트 및 피처 생성
    ├─ 03_ML모델비교.ipynb
    ├─ 04_피처통합데이터.ipynb
    ├─ 05_ML모델비교.ipynb    # 최종 모델 비교 및 선정
    ├─ columns.json          # 활용 컬럼 관리
    ├─ preprocess.py         # 전처리/타깃 생성 모듈
    └─ modules/
        ├─ features_ksh.py   # 연령, 가구, 소득, 치매 파생변수
        ├─ features_mhs.py   # 시간 변환 파생변수
        ├─ features_ohj.py   # 교육, 경제, 혼인 파생변수
        ├─ features_pdy.py   # 체중조절, 신체활동 파생변수
        └─ features_sangmin.py  # 식생활, 비만, 구강 파생변수

# (운영 구상) 모델 패키지 코드
smoke_churn_model/
 ├─ component/
 │   ├─ train.py      # 최종 모델 학습
 │   ├─ evaluate.py   # 최종 모델 평가
 │   ├─ predict.py    # 최종 모델 예측
 │   └─ cv.py         # K-Fold 학습 및 검증
 ├─ modules/
 │   ├─ config.py     # 경로 및 환경설정
 │   └─ preprocess.py # 데이터 로드 및 전처리 
 ├─ resource/
 │   └─ columns.json  # 활용 피처 관리
 └─ model.ipynb

# Streamlit 대시보드
streamlit/
 ├─ app.py            # 메인 앱
 ├─ pages/
 │   ├─ 01_환자_정보_입력.py
 │   ├─ 02_상담자_전용.py
 │   └─ 90_설정_및_도움말.py
 ├─ utils/
 │   ├─ pdf_utils.py
 │   ├─ plot_utils.py
 │   ├─ state.py
 │   └─ theme.py
 ├─ style/
 │   └─ base.css
 └─ requirements.txt

# 문서 저장소
docs/
 ├─ img/
 │   ├─ eda/          # EDA 시각화
 │   └─ model/        # 모델 시각화
 ├─ summary/
 │   ├─ eda/          # 데이터전처리결과서
 │   └─ model/        # 인공지능학습결과서
 └─ master/
     └─ context.md    # 프로젝트 마스터 문서
```

### 7-2. 협업 방식
- **Git/GitHub**: 브랜치 전략 (feature/개인명-작업내용)
- **PR & Code Review**: 팀 리뷰 후 병합
- **Issue Tracking**: GitHub Issues 활용
- **회의**: 주 2-3회 정기 회의, Notion으로 회의록 관리
- **문서 공유**: Notion (WBS, 회고, 실험 노트)

### 7-3. 데이터 관리
- **원본 데이터**: `data/raw_data.csv` (Git 제외, .gitignore 설정)
- **전처리 데이터**: `data/analy_data_v2.csv`, `data/prep_data_v2.csv`
- **백업**: 로컬 백업 및 팀 공유 드라이브 활용

---

## 8. 향후 계획 및 한계

### 8-1. 운영 전환 계획
**배경:**
- 설문조사 데이터는 매년(예: 2024→2025) 갱신됨
- `smoke_churn_model`을 운영 모드로 고도화하여 주기적 데이터 업데이트/재학습 목표

**현재 상태:**
- 데이터 파이프라인 실험 완료
- 최종 모델의 운영 패키징(훈련/추론 스크립트, CI/CD)은 추가 개선 시간 필요

**향후 계획:**
1. 피처/파이프라인 버저닝 시스템 구축
2. 모델 아티팩트(.pkl) 저장/로딩 일원화
3. 주기적 모니터링/재학습 자동화
4. 데이터 드리프트 모니터링 체계 구축
5. SHAP 값 기반 개인별 해석 리포트 추가

### 8-2. 한계점
1. **정보 손실**: 설문 특수코드(7,8,9→NaN) 처리로 인한 일부 정보 손실
2. **교란 가능성**: 교차연결 변수의 잠재적 교란 가능성 존재
3. **설문 변경 리스크**: 연도별 설문 설계 변화 시 모델 성능 저하 가능
4. **단면 조사 한계**: 시계열 추적 불가, 인과관계 추론 제한
5. **운영 패키징 미완**: 시간 제약으로 운영 모드 고도화 미완성

### 8-3. 개선 계획
1. **모델 성능 개선**:
   - 앙상블 기법 추가 실험
   - 심층 특성 상호작용 분석
   - 시계열 데이터 확보 시 longitudinal 모델 검토

2. **운영 안정성**:
   - 모델 모니터링 지표 설정 (입력 데이터 드리프트, 성능 저하 알림)
   - 재학습 트리거 조건 명확화
   - A/B 테스트 프레임워크 구축

3. **사용자 경험**:
   - Streamlit 대시보드 UI/UX 개선
   - 실시간 피드백 수집 시스템
   - 상담자 교육 자료 제작

---

## 9. 참고 정보

### 9-1. 용어 및 라벨 일관성 원칙
- 변수명·축 라벨·범주값은 매핑 테이블(`columns.json`)을 통해 한글화/설명 추가
- 수치형 코드의 의미(예: 1=남자, 2=여자)는 문서와 코드 모두 동일 매핑 사용

### 9-2. 데이터 해석 프레임
- 컬럼별 EDA: 분포·상관·교호작용 검토, 가설 수립/검증, 파생 변수 설계 기준 명시
- 목표 변수: 금연 성공 여부 y∈{0,1} (1=금연 성공, 고객 이탈)로 정의하여 이진 분류로 접근

### 9-3. 주요 링크
- **WBS**: [Notion WBS 페이지](https://www.notion.so/27f649136c11814db5cff4f0082b24d9?pvs=21)
- **EDA 분석**: [Notion EDA 페이지](https://www.notion.so/EDA-27f649136c1181f8822fd6c052931839?pvs=21)
- **최종 회고**: [Notion 회고 페이지](https://www.notion.so/27f649136c11818e80b7ed752f31a687?pvs=21)

---

## 문서 이력
- 2025.10.15: 최초 작성 (프로젝트 마스터 문서 통합)
- 내용: 프로젝트 개요, 데이터 이해, 전처리, EDA, 모델링, 산출물, 관리, 향후 계획 통합 정리
